<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Space Wars V0.5</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #000;
      color: #fff;
      overflow: hidden;
    }
    canvas {
      display: block;
      background: linear-gradient(#111, #333);
    }
    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      right: 10px;
      display: flex;
      justify-content: space-between;
      pointer-events: none;
    }
    .stats {
      background: rgba(0, 0, 0, 0.6);
      padding: 10px;
      border-radius: 10px;
      pointer-events: auto;
    }
    .green { color: lime; }
    .red { color: red; }
    #autoPlayBtn {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      font-size: 16px;
      background: #444;
      color: #fff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    #message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 32px;
      font-weight: bold;
      color: yellow;
      display: none;
    }
    #gameOver {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 30px;
      border-radius: 20px;
      text-align: center;
      display: none;
    }
    #gameOver button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      background: #555;
      color: #fff;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <div id="ui">
    <div class="stats red" id="redStats"></div>
    <div class="stats green" id="greenStats"></div>
  </div>
  <button id="autoPlayBtn">Toggle Auto-Play</button>
  <div id="message"></div>
  <div id="gameOver">
    <h1 id="winnerText"></h1>
    <div id="finalStats"></div>
    <button onclick="location.reload()">Play Again</button>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const redStats = document.getElementById('redStats');
    const greenStats = document.getElementById('greenStats');
    const message = document.getElementById('message');
    const gameOver = document.getElementById('gameOver');
    const winnerText = document.getElementById('winnerText');
    const finalStats = document.getElementById('finalStats');
    let autoPlay = true;

    const playerSize = 30;
    const bulletSpeed = 5;
    const objectSize = 20;

    const greenPlayer = {
      x: 100, y: 300, score: 0, lives: 3, shield: 100
    };
    const redPlayer = {
      x: 700, y: 300, score: 0, lives: 3, shield: 100
    };

    const bullets = [];
    const objects = [];

    function drawPlayer(player, color) {
      ctx.fillStyle = color;
      ctx.beginPath();
      ctx.arc(player.x, player.y, playerSize / 2, 0, Math.PI * 2);
      ctx.fill();
    }

    function drawObject(obj) {
      ctx.fillStyle = 'gold';
      ctx.fillRect(obj.x, obj.y, objectSize, objectSize);
    }

    function drawBullet(bullet) {
      ctx.fillStyle = bullet.color;
      ctx.fillRect(bullet.x, bullet.y, 6, 3);
    }

    function shoot(player, color, direction) {
      bullets.push({ x: player.x, y: player.y, color, dx: direction });
    }

    function spawnObject() {
      objects.push({ x: Math.random() * (canvas.width - objectSize), y: Math.random() * (canvas.height - objectSize) });
    }

    setInterval(() => {
      spawnObject();
    }, 1500);

    function flashMessage(text) {
      message.innerText = text;
      message.style.display = 'block';
      setTimeout(() => message.style.display = 'none', 1000);
    }

    function updateStats() {
      greenStats.innerHTML = `Score: ${greenPlayer.score} | Lives: ${greenPlayer.lives} | Shield: ${greenPlayer.shield}`;
      redStats.innerHTML = `Score: ${redPlayer.score} | Lives: ${redPlayer.lives} | Shield: ${redPlayer.shield}`;
    }

    function endGame(winner) {
      winnerText.innerText = `${winner} wins!`;
      finalStats.innerHTML = `Green: ${greenPlayer.score} pts, ${greenPlayer.lives} lives<br>Red: ${redPlayer.score} pts, ${redPlayer.lives} lives`;
      gameOver.style.display = 'block';
    }

    document.getElementById('autoPlayBtn').onclick = () => {
      autoPlay = !autoPlay;
    };

    document.addEventListener('mousemove', e => {
      if (!autoPlay) {
        greenPlayer.y = e.clientY;
      }
    });

    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      drawPlayer(greenPlayer, 'lime');
      drawPlayer(redPlayer, 'red');

      objects.forEach(drawObject);
      bullets.forEach(drawBullet);

      bullets.forEach((bullet, i) => {
        bullet.x += bullet.dx * bulletSpeed;

        objects.forEach((obj, j) => {
          if (bullet.x < obj.x + objectSize && bullet.x + 6 > obj.x &&
              bullet.y < obj.y + objectSize && bullet.y + 3 > obj.y) {
            bullets.splice(i, 1);
            objects.splice(j, 1);
            if (bullet.color === 'lime') greenPlayer.score += 10;
            else redPlayer.score += 10;
            flashMessage('+10!');
          }
        });
      });

      if (autoPlay) greenPlayer.y += Math.sin(Date.now() / 500) * 2;

      if (Math.random() < 0.02) shoot(greenPlayer, 'lime', 1);
      if (Math.random() < 0.02) shoot(redPlayer, 'red', -1);

      // Check for lives
      if (greenPlayer.lives <= 0) endGame('Red');
      if (redPlayer.lives <= 0) endGame('Green');

      // Regen shields slowly
      greenPlayer.shield = Math.min(100, greenPlayer.shield + 0.05);
      redPlayer.shield = Math.min(100, redPlayer.shield + 0.05);

      updateStats();
      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>
